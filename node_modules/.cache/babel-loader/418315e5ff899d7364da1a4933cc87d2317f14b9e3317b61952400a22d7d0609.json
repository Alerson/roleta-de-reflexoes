{"ast":null,"code":"import React,{useState,useEffect}from'react';import audioService from'../../services/AudioService';import'./MusicaControle.css';import{jsx as _jsx}from\"react/jsx-runtime\";const MusicaControle=_ref=>{let{musicaSrc='/musicas/relaxing-background.mp3'}=_ref;const[tocando,setTocando]=useState(false);// Inicializar o servi칞o de 치udio e sincronizar estado\nuseEffect(()=>{// Verificar estado atual em vez de reinicializar\nif(!audioService.initialized){try{audioService.init(musicaSrc);}catch(error){console.error('Erro ao inicializar 치udio:',error);}}// Importante: Sincronizar estado inicial com o servi칞o\nconst estadoInicial=audioService.isPlaying();setTocando(estadoInicial);console.log('Estado inicial do 치udio:',estadoInicial);// Escutar mudan칞as de estado do 치udio\nconst handleAudioChange=event=>{if(event.detail&&typeof event.detail.isPlaying==='boolean'){console.log('Evento de mudan칞a de 치udio recebido:',event.detail.isPlaying);setTocando(event.detail.isPlaying);}};document.addEventListener('audioStateChange',handleAudioChange);return()=>{document.removeEventListener('audioStateChange',handleAudioChange);};},[musicaSrc]);// Alternar entre tocar e pausar a m칰sica\nconst toggleMusica=()=>{try{const novoEstado=audioService.toggle();console.log('Toggle de m칰sica: novo estado =',novoEstado);setTocando(novoEstado);// Armazenar estado no localStorage para persist칡ncia\nlocalStorage.setItem('musicaAtiva',novoEstado.toString());// Disparar evento para outros componentes que possam estar escutando\nconst event=new CustomEvent('audioStateChange',{detail:{isPlaying:novoEstado}});document.dispatchEvent(event);}catch(error){console.error('Erro ao alternar m칰sica:',error);}};return/*#__PURE__*/_jsx(\"button\",{className:`musica-controle ${tocando?'tocando':'pausado'}`,onClick:toggleMusica,\"aria-label\":tocando?'Pausar m칰sica':'Tocar m칰sica',title:tocando?'Pausar m칰sica':'Tocar m칰sica',children:tocando?/*#__PURE__*/_jsx(\"span\",{className:\"musica-icon tocando\",role:\"img\",\"aria-label\":\"M\\xFAsica tocando\",children:\"\\uD83D\\uDD0A\"}):/*#__PURE__*/_jsx(\"span\",{className:\"musica-icon pausado\",role:\"img\",\"aria-label\":\"M\\xFAsica pausada\",children:\"\\uD83D\\uDD07\"})});};export default MusicaControle;","map":{"version":3,"names":["React","useState","useEffect","audioService","jsx","_jsx","MusicaControle","_ref","musicaSrc","tocando","setTocando","initialized","init","error","console","estadoInicial","isPlaying","log","handleAudioChange","event","detail","document","addEventListener","removeEventListener","toggleMusica","novoEstado","toggle","localStorage","setItem","toString","CustomEvent","dispatchEvent","className","onClick","title","children","role"],"sources":["/Users/alersonrigo/workspace/roleta-de-reflexoes/src/components/MusicaControle/MusicaControle.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport audioService from '../../services/AudioService';\nimport './MusicaControle.css';\n\nconst MusicaControle = ({ musicaSrc = '/musicas/relaxing-background.mp3' }) => {\n  const [tocando, setTocando] = useState(false);\n\n  // Inicializar o servi칞o de 치udio e sincronizar estado\n  useEffect(() => {\n    // Verificar estado atual em vez de reinicializar\n    if (!audioService.initialized) {\n      try {\n        audioService.init(musicaSrc);\n      } catch (error) {\n        console.error('Erro ao inicializar 치udio:', error);\n      }\n    }\n    \n    // Importante: Sincronizar estado inicial com o servi칞o\n    const estadoInicial = audioService.isPlaying();\n    setTocando(estadoInicial);\n    console.log('Estado inicial do 치udio:', estadoInicial);\n    \n    // Escutar mudan칞as de estado do 치udio\n    const handleAudioChange = (event) => {\n      if (event.detail && typeof event.detail.isPlaying === 'boolean') {\n        console.log('Evento de mudan칞a de 치udio recebido:', event.detail.isPlaying);\n        setTocando(event.detail.isPlaying);\n      }\n    };\n    \n    document.addEventListener('audioStateChange', handleAudioChange);\n    \n    return () => {\n      document.removeEventListener('audioStateChange', handleAudioChange);\n    };\n  }, [musicaSrc]);\n\n  // Alternar entre tocar e pausar a m칰sica\n  const toggleMusica = () => {\n    try {\n      const novoEstado = audioService.toggle();\n      console.log('Toggle de m칰sica: novo estado =', novoEstado);\n      setTocando(novoEstado);\n      \n      // Armazenar estado no localStorage para persist칡ncia\n      localStorage.setItem('musicaAtiva', novoEstado.toString());\n      \n      // Disparar evento para outros componentes que possam estar escutando\n      const event = new CustomEvent('audioStateChange', { \n        detail: { isPlaying: novoEstado } \n      });\n      document.dispatchEvent(event);\n    } catch (error) {\n      console.error('Erro ao alternar m칰sica:', error);\n    }\n  };\n\n  return (\n    <button \n      className={`musica-controle ${tocando ? 'tocando' : 'pausado'}`}\n      onClick={toggleMusica}\n      aria-label={tocando ? 'Pausar m칰sica' : 'Tocar m칰sica'}\n      title={tocando ? 'Pausar m칰sica' : 'Tocar m칰sica'}\n    >\n      {tocando ? (\n        <span className=\"musica-icon tocando\" role=\"img\" aria-label=\"M칰sica tocando\">\n          游댉\n        </span>\n      ) : (\n        <span className=\"musica-icon pausado\" role=\"img\" aria-label=\"M칰sica pausada\">\n          游댆\n        </span>\n      )}\n    </button>\n  );\n};\n\nexport default MusicaControle;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}